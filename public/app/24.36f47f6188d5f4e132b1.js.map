{"version":3,"sources":["webpack:///24.36f47f6188d5f4e132b1.js","webpack:///./resources/assets/app/pages/settings/Roles.vue","webpack:///Roles.vue","webpack:///./resources/assets/app/components/user/person-card.js","webpack:///./resources/assets/app/assets/settings/roles.svg","webpack:///./resources/assets/app/pages/settings/Roles.vue?dd67"],"names":["webpackJsonp","437","module","exports","__webpack_require__","Component","636","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_regenerator","_regenerator2","_asyncToGenerator2","_asyncToGenerator3","_extends2","_extends3","_lodash","_lodash2","_vuex","_util","_personCard","_personCard2","_sidebar","_sidebar2","name","data","roles","people","computed","sidebarId","methods","remove","role","user","_this","this","mark","_callee","result","index","wrap","_context","prev","next","$wait","abrupt","$error","revoke","id","user_id","sent","$users","findIndex","u","splice","errors","$message","stop","add","_this2","_callee2","_context2","clone","push","assign","getAllRoles","_this3","_callee3","_ref","i","_ref2","users","_context3","map","length","onSearch","_ref3","_callee4","_ref4","items","q","arguments","undefined","_context4","search","personType","apply","mapActions","created","components","PersonCard","mixins","639","_Card","_Card2","_Card3","_Card4","_Card5","_Card6","functional","props","person","type","required","render","h","ctx","_type","children","702","753","_vm","_h","$createElement","_c","_self","_b","title","subtitle","slot","_v","staticClass","attrs","src","_s","_l","description","component","placeholder","on","select","suggestions","domProps","innerHTML","_e","class","disabled","$event","staticStyle","margin-bottom","staticRenderFns"],"mappings":"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","file":"24.36f47f6188d5f4e132b1.js","sourcesContent":["webpackJsonp([24,39],{\n\n/***/ 437:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar Component = __webpack_require__(0)(\n  /* script */\n  __webpack_require__(636),\n  /* template */\n  __webpack_require__(753),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 636:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(exports,\"__esModule\",{value:true});var _regenerator=__webpack_require__(3);var _regenerator2=_interopRequireDefault(_regenerator);var _asyncToGenerator2=__webpack_require__(2);var _asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2);var _extends2=__webpack_require__(5);var _extends3=_interopRequireDefault(_extends2);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar _lodash=__webpack_require__(115);var _lodash2=_interopRequireDefault(_lodash);\nvar _vuex=__webpack_require__(4);\nvar _util=__webpack_require__(8);\nvar _personCard=__webpack_require__(639);var _personCard2=_interopRequireDefault(_personCard);\nvar _sidebar=__webpack_require__(403);var _sidebar2=_interopRequireDefault(_sidebar);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}exports.default=\n\n{\nname:'Roles',\n\ndata:function data(){return{\nroles:[],\npeople:[]};},\n\n\ncomputed:{\nsidebarId:function sidebarId(){return'settings.roles';}},\n\n\nmethods:(0,_extends3.default)({\nremove:function remove(role,user){var _this=this;return(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(){var result,index;return _regenerator2.default.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(\nuser.$wait===true)){_context.next=2;break;}return _context.abrupt('return',false);case 2:\n\nuser.$wait=true;\nrole.$error=null;_context.next=6;return(\n_this.revoke({role:role.id,user:user.user_id}));case 6:result=_context.sent;\nuser.$wait=false;\n\nif(result===true){\nindex=role.$users.findIndex(function(u){return user.id===u.id;});\n\nif(index>-1)role.$users.splice(index,1);\n}else if('errors'in result){\nrole.$error=result.errors.$message;\n}case 9:case'end':return _context.stop();}}},_callee,_this);}))();\n},\n\nadd:function add(role,user){var _this2=this;return(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2(){var result,index;return _regenerator2.default.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(\nrole.$users.findIndex(function(u){return user.id===u.id;})>-1)){_context2.next=2;break;}return _context2.abrupt('return',false);case 2:\n\nuser=(0,_util.clone)(user);\n\nrole.$users.push(user);\nuser.$wait=true;\nrole.$error=null;_context2.next=8;return(\n_this2.assign({role:role.id,user:user.user_id}));case 8:result=_context2.sent;\n\nif(result===true){\nuser.$wait=false;\n}else{\nrole.$error=result.errors.$message;\n\nindex=role.$users.findIndex(function(u){return user.id===u.id;});\n\nif(index>-1)role.$users.splice(index,1);\n}case 10:case'end':return _context2.stop();}}},_callee2,_this2);}))();\n},\n\ngetAllRoles:function getAllRoles(){var _this3=this;return(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(){var _ref,roles,i,_ref2,users;return _regenerator2.default.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return(\n_this3.index());case 2:_ref=_context3.sent;roles=_ref.roles;\n\n_this3.roles=(roles||[]).map(function(role){return(0,_extends3.default)({$users:[]},role);});\n\ni=0;case 6:if(!(i<_this3.roles.length)){_context3.next=15;break;}_context3.next=9;return(\n_this3.users(_this3.roles[i].id));case 9:_ref2=_context3.sent;users=_ref2.users;\n\n_this3.roles[i].$users=(users||[]).map(function(user){return(0,_extends3.default)({$wait:false},user);});case 12:i+=1;_context3.next=6;break;case 15:case'end':return _context3.stop();}}},_callee3,_this3);}))();\n\n},\n\nonSearch:(0,_lodash2.default)(function(){var _ref3=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4(){var q=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var _ref4,items;return _regenerator2.default.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return(\nthis.search({q:q,personType:['teacher','employee']}));case 2:_ref4=_context4.sent;items=_ref4.items;\n\nthis.people=items||[];case 5:case'end':return _context4.stop();}}},_callee4,this);}));return function(){return _ref3.apply(this,arguments);};}(),\n400)},\n\n(0,_vuex.mapActions)('roles',['index','users','assign','revoke']),\n\n(0,_vuex.mapActions)('people',{search:'index'})),\n\n\ncreated:function created(){\nthis.getAllRoles();\nthis.onSearch();\n},\n\ncomponents:{PersonCard:_personCard2.default},\n\nmixins:[_sidebar2.default]};\n\n/***/ }),\n\n/***/ 639:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(exports,\"__esModule\",{value:true});var _Card=__webpack_require__(402);var _Card2=_interopRequireDefault(_Card);\nvar _Card3=__webpack_require__(400);var _Card4=_interopRequireDefault(_Card3);\nvar _Card5=__webpack_require__(407);var _Card6=_interopRequireDefault(_Card5);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}exports.default=\n\n{\nfunctional:true,\n\nprops:{\nperson:{\ntype:Object,\nrequired:true}},\n\n\n\nrender:function render(h,ctx){\nvar type=ctx.props.person._type;\n\nctx.data.props=ctx.data.props||{};\nctx.data.props[type]=ctx.props.person;\n\nswitch(type){\ncase'student':\nreturn h(_Card2.default,ctx.data,ctx.children);\ncase'teacher':\nreturn h(_Card4.default,ctx.data,ctx.children);\ncase'employee':\nreturn h(_Card6.default,ctx.data,ctx.children);}\n\n}};\n\n/***/ }),\n\n/***/ 702:\n/***/ (function(module, exports) {\n\nmodule.exports = \"/app/images/roles.svg?5216e320e3eb175a9891bb04ebd627d5\";\n\n/***/ }),\n\n/***/ 753:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('container-window', _vm._b({}, 'container-window', {\n    title: _vm.title,\n    subtitle: _vm.subtitle\n  }), [_c('template', {\n    slot: \"sidebar\"\n  }, [_c('sidebar')], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"container-zero my-3 py-3 text-center\"\n  }, [_c('img', {\n    attrs: {\n      \"src\": __webpack_require__(702)\n    }\n  })]), _vm._v(\" \"), _c('div', {\n    staticClass: \"container-zero py-3\"\n  }, [_c('div', {\n    staticClass: \"row\"\n  }, [_c('h2', {\n    staticClass: \"col-12 text-center\"\n  }, [_vm._v(_vm._s(_vm.title))]), _vm._v(\" \"), _c('p', {\n    staticClass: \"col-12 text-center\"\n  }, [_vm._v(\"Assign roles to teachers & employees.\")])])]), _vm._v(\" \"), _vm._l((_vm.roles), function(role) {\n    return _c('div', [_c('h6', {\n      staticClass: \"split-header text-uppercase my-3 py-3\"\n    }, [_vm._v(_vm._s(role.name))]), _vm._v(\" \"), _c('div', {\n      staticClass: \"container-zero py-3\"\n    }, [_c('div', {\n      staticClass: \"row\"\n    }, [_c('p', {\n      staticClass: \"col-12 pb-3 text-center\"\n    }, [_vm._v(_vm._s(role.description))]), _vm._v(\" \"), _c('div', {\n      staticClass: \"col-12\"\n    }, [_c('typeahead', _vm._b({\n      attrs: {\n        \"component\": \"SelectOptionUser\",\n        \"placeholder\": \"Start typing...\"\n      },\n      on: {\n        \"search\": _vm.onSearch,\n        \"select\": function (user) { return _vm.add(role, user); }\n      }\n    }, 'typeahead', {\n      suggestions: _vm.people,\n      value: []\n    }))], 1), _vm._v(\" \"), (role.$error) ? _c('div', {\n      staticClass: \"col-12 mt-3\"\n    }, [_c('alert', {\n      attrs: {\n        \"type\": \"danger\"\n      },\n      domProps: {\n        \"innerHTML\": _vm._s(role.$error)\n      }\n    })], 1) : _vm._e(), _vm._v(\" \"), _vm._l((role.$users), function(person) {\n      return _c('div', {\n        staticClass: \"col-12 col-lg-6 mt-3\"\n      }, [_c('person-card', {\n        class: {\n          disabled: person.$wait\n        },\n        attrs: {\n          \"person\": person,\n          \"remove\": \"\"\n        },\n        on: {\n          \"remove\": function($event) {\n            _vm.remove(role, person)\n          }\n        }\n      })], 1)\n    }), _vm._v(\" \"), (role.$users.length === 0) ? _c('div', {\n      staticClass: \"col-12 py-3 my-3 text-center text-muted\"\n    }, [_vm._v(\"\\n          Choose a teacher or employee\\n        \")]) : _vm._e()], 2)])])\n  }), _vm._v(\" \"), _c('div', {\n    staticStyle: {\n      \"margin-bottom\": \"160px\"\n    }\n  })], 2)\n},staticRenderFns: []}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 24.36f47f6188d5f4e132b1.js","var Component = require(\"!../../../../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Roles.vue\"),\n  /* template */\n  require(\"!!../../../../../node_modules/vue-loader/lib/template-compiler?{\\\"id\\\":\\\"data-v-a6da2daa\\\"}!../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Roles.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./resources/assets/app/pages/settings/Roles.vue\n// module id = 437\n// module chunks = 24","<template>\n<container-window v-bind=\"{ title, subtitle }\">\n  <template slot=\"sidebar\">\n  <sidebar/>\n  </template>\n\n  <div class=\"container-zero my-3 py-3 text-center\">\n    <img src=\"../../assets/settings/roles.svg\">\n  </div>\n\n  <div class=\"container-zero py-3\">\n    <div class=\"row\">\n\n      <h2 class=\"col-12 text-center\">{{ title }}</h2>\n\n      <p class=\"col-12 text-center\">Assign roles to teachers & employees.</p>\n\n    </div>\n  </div>\n\n  <div v-for=\"role in roles\">\n\n    <h6 class=\"split-header text-uppercase my-3 py-3\">{{ role.name }}</h6>\n\n    <div class=\"container-zero py-3\">\n      <div class=\"row\">\n\n        <p class=\"col-12 pb-3 text-center\">{{ role.description }}</p>\n\n        <div class=\"col-12\">\n          <typeahead v-bind=\"{ suggestions: people, value: [] }\"\n                     component=\"SelectOptionUser\" placeholder=\"Start typing...\"\n                     @search=\"onSearch\" @select=\"user => add(role, user)\"/>\n        </div>\n\n        <div class=\"col-12 mt-3\" v-if=\"role.$error\">\n          <alert type=\"danger\" v-html=\"role.$error\"/>\n        </div>\n\n        <div class=\"col-12 col-lg-6 mt-3\" v-for=\"person in role.$users\">\n          <person-card :person=\"person\" remove @remove=\"remove(role, person)\" :class=\"{ disabled: person.$wait }\"/>\n        </div>\n\n        <div v-if=\"role.$users.length === 0\" class=\"col-12 py-3 my-3 text-center text-muted\">\n          Choose a teacher or employee\n        </div>\n\n      </div>\n    </div>\n\n  </div>\n\n  <div style=\"margin-bottom: 160px\"></div>\n\n</container-window>\n</template>\n\n<script lang=\"babel\">\nimport throttle from 'lodash.throttle'\nimport { mapActions, mapGetters } from 'vuex'\nimport { clone } from '../../util'\nimport PersonCard from '../../components/user/person-card'\nimport Sidebar from './mixins/sidebar'\n\nexport default {\n  name: 'Roles',\n\n  data: () => ({\n    roles: [],\n    people: []\n  }),\n\n  computed: {\n    sidebarId: () => 'settings.roles'\n  },\n\n  methods: {\n    async remove (role, user) {\n      if (user.$wait === true) return false\n\n      user.$wait = true\n      role.$error = null\n      const result = await this.revoke({ role: role.id, user: user.user_id })\n      user.$wait = false\n\n      if (result === true) {\n        const index = role.$users.findIndex(u => user.id === u.id)\n\n        if (index > -1) role.$users.splice(index, 1)\n      } else if ('errors' in result) {\n        role.$error = result.errors.$message\n      }\n    },\n\n    async add (role, user) {\n      if (role.$users.findIndex(u => user.id === u.id) > -1) return false\n\n      user = clone(user)\n\n      role.$users.push(user)\n      user.$wait = true\n      role.$error = null\n      const result = await this.assign({ role: role.id, user: user.user_id })\n\n      if (result === true) {\n        user.$wait = false\n      } else {\n        role.$error = result.errors.$message\n\n        const index = role.$users.findIndex(u => user.id === u.id)\n\n        if (index > -1) role.$users.splice(index, 1)\n      }\n    },\n\n    async getAllRoles () {\n      const { roles } = await this.index()\n\n      this.roles = (roles || []).map(role => ({ $users: [], ...role }))\n\n      for (let i = 0; i < this.roles.length; i += 1) {\n        const { users } = await this.users(this.roles[i].id)\n\n        this.roles[i].$users = (users || []).map(user => ({ $wait: false, ...user }))\n      }\n    },\n\n    onSearch: throttle(async function (q = '') {\n      const { items } = await this.search({ q, personType: ['teacher', 'employee'] })\n\n      this.people = items || []\n    }, 400),\n\n    ...mapActions('roles', ['index', 'users', 'assign', 'revoke']),\n\n    ...mapActions('people', { search: 'index' })\n  },\n\n  created () {\n    this.getAllRoles()\n    this.onSearch()\n  },\n\n  components: { PersonCard },\n\n  mixins: [Sidebar]\n}\n</script>\n\n\n\n// WEBPACK FOOTER //\n// Roles.vue?56a21f54","import StudentCard from '../student/Card.vue'\nimport TeacherCard from '../teacher/Card.vue'\nimport EmployeeCard from '../employee/Card.vue'\n\nexport default {\n  functional: true,\n\n  props: {\n    person: {\n      type: Object,\n      required: true\n    }\n  },\n\n  render (h, ctx) {\n    const type = ctx.props.person._type\n\n    ctx.data.props = (ctx.data.props || {})\n    ctx.data.props[type] = ctx.props.person\n\n    switch (type) {\n      case 'student':\n        return h(StudentCard, ctx.data, ctx.children)\n      case 'teacher':\n        return h(TeacherCard, ctx.data, ctx.children)\n      case 'employee':\n        return h(EmployeeCard, ctx.data, ctx.children)\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./resources/assets/app/components/user/person-card.js","module.exports = \"/app/images/roles.svg?5216e320e3eb175a9891bb04ebd627d5\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./resources/assets/app/assets/settings/roles.svg\n// module id = 702\n// module chunks = 24","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('container-window', _vm._b({}, 'container-window', {\n    title: _vm.title,\n    subtitle: _vm.subtitle\n  }), [_c('template', {\n    slot: \"sidebar\"\n  }, [_c('sidebar')], 1), _vm._v(\" \"), _c('div', {\n    staticClass: \"container-zero my-3 py-3 text-center\"\n  }, [_c('img', {\n    attrs: {\n      \"src\": require(\"../../assets/settings/roles.svg\")\n    }\n  })]), _vm._v(\" \"), _c('div', {\n    staticClass: \"container-zero py-3\"\n  }, [_c('div', {\n    staticClass: \"row\"\n  }, [_c('h2', {\n    staticClass: \"col-12 text-center\"\n  }, [_vm._v(_vm._s(_vm.title))]), _vm._v(\" \"), _c('p', {\n    staticClass: \"col-12 text-center\"\n  }, [_vm._v(\"Assign roles to teachers & employees.\")])])]), _vm._v(\" \"), _vm._l((_vm.roles), function(role) {\n    return _c('div', [_c('h6', {\n      staticClass: \"split-header text-uppercase my-3 py-3\"\n    }, [_vm._v(_vm._s(role.name))]), _vm._v(\" \"), _c('div', {\n      staticClass: \"container-zero py-3\"\n    }, [_c('div', {\n      staticClass: \"row\"\n    }, [_c('p', {\n      staticClass: \"col-12 pb-3 text-center\"\n    }, [_vm._v(_vm._s(role.description))]), _vm._v(\" \"), _c('div', {\n      staticClass: \"col-12\"\n    }, [_c('typeahead', _vm._b({\n      attrs: {\n        \"component\": \"SelectOptionUser\",\n        \"placeholder\": \"Start typing...\"\n      },\n      on: {\n        \"search\": _vm.onSearch,\n        \"select\": function (user) { return _vm.add(role, user); }\n      }\n    }, 'typeahead', {\n      suggestions: _vm.people,\n      value: []\n    }))], 1), _vm._v(\" \"), (role.$error) ? _c('div', {\n      staticClass: \"col-12 mt-3\"\n    }, [_c('alert', {\n      attrs: {\n        \"type\": \"danger\"\n      },\n      domProps: {\n        \"innerHTML\": _vm._s(role.$error)\n      }\n    })], 1) : _vm._e(), _vm._v(\" \"), _vm._l((role.$users), function(person) {\n      return _c('div', {\n        staticClass: \"col-12 col-lg-6 mt-3\"\n      }, [_c('person-card', {\n        class: {\n          disabled: person.$wait\n        },\n        attrs: {\n          \"person\": person,\n          \"remove\": \"\"\n        },\n        on: {\n          \"remove\": function($event) {\n            _vm.remove(role, person)\n          }\n        }\n      })], 1)\n    }), _vm._v(\" \"), (role.$users.length === 0) ? _c('div', {\n      staticClass: \"col-12 py-3 my-3 text-center text-muted\"\n    }, [_vm._v(\"\\n          Choose a teacher or employee\\n        \")]) : _vm._e()], 2)])])\n  }), _vm._v(\" \"), _c('div', {\n    staticStyle: {\n      \"margin-bottom\": \"160px\"\n    }\n  })], 2)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?{\"id\":\"data-v-a6da2daa\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./resources/assets/app/pages/settings/Roles.vue\n// module id = 753\n// module chunks = 24"],"sourceRoot":""}