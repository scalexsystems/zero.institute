webpackJsonp([24,39],{437:function(e,t,r){var n=r(0)(r(636),r(753),null,null);e.exports=n.exports},636:function(e,t,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),s=_interopRequireDefault(n),a=r(2),i=_interopRequireDefault(a),o=r(5),u=_interopRequireDefault(o),l=r(115),c=_interopRequireDefault(l),d=r(4),p=r(8),f=r(639),_=_interopRequireDefault(f),v=r(403),h=_interopRequireDefault(v);t.default={name:"Roles",data:function(){return{roles:[],people:[]}},computed:{sidebarId:function(){return"settings.roles"}},methods:(0,u.default)({remove:function(e,t){var r=this;return(0,i.default)(s.default.mark(function _callee(){var n,a;return s.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t.$wait!==!0){s.next=2;break}return s.abrupt("return",!1);case 2:return t.$wait=!0,e.$error=null,s.next=6,r.revoke({role:e.id,user:t.user_id});case 6:n=s.sent,t.$wait=!1,n===!0?(a=e.$users.findIndex(function(e){return t.id===e.id}),a>-1&&e.$users.splice(a,1)):"errors"in n&&(e.$error=n.errors.$message);case 9:case"end":return s.stop()}},_callee,r)}))()},add:function(e,t){var r=this;return(0,i.default)(s.default.mark(function _callee2(){var n,a;return s.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(e.$users.findIndex(function(e){return t.id===e.id})>-1)){s.next=2;break}return s.abrupt("return",!1);case 2:return t=(0,p.clone)(t),e.$users.push(t),t.$wait=!0,e.$error=null,s.next=8,r.assign({role:e.id,user:t.user_id});case 8:n=s.sent,n===!0?t.$wait=!1:(e.$error=n.errors.$message,a=e.$users.findIndex(function(e){return t.id===e.id}),a>-1&&e.$users.splice(a,1));case 10:case"end":return s.stop()}},_callee2,r)}))()},getAllRoles:function(){var e=this;return(0,i.default)(s.default.mark(function _callee3(){var t,r,n,a,i;return s.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.index();case 2:t=s.sent,r=t.roles,e.roles=(r||[]).map(function(e){return(0,u.default)({$users:[]},e)}),n=0;case 6:if(!(n<e.roles.length)){s.next=15;break}return s.next=9,e.users(e.roles[n].id);case 9:a=s.sent,i=a.users,e.roles[n].$users=(i||[]).map(function(e){return(0,u.default)({$wait:!1},e)});case 12:n+=1,s.next=6;break;case 15:case"end":return s.stop()}},_callee3,e)}))()},onSearch:(0,c.default)(function(){var e=(0,i.default)(s.default.mark(function _callee4(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return s.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.search({q:r,personType:["teacher","employee"]});case 2:e=n.sent,t=e.items,this.people=t||[];case 5:case"end":return n.stop()}},_callee4,this)}));return function(){return e.apply(this,arguments)}}(),400)},(0,d.mapActions)("roles",["index","users","assign","revoke"]),(0,d.mapActions)("people",{search:"index"})),created:function(){this.getAllRoles(),this.onSearch()},components:{PersonCard:_.default},mixins:[h.default]}},639:function(e,t,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(402),s=_interopRequireDefault(n),a=r(400),i=_interopRequireDefault(a),o=r(407),u=_interopRequireDefault(o);t.default={functional:!0,props:{person:{type:Object,required:!0}},render:function(e,t){var r=t.props.person._type;switch(t.data.props=t.data.props||{},t.data.props[r]=t.props.person,r){case"student":return e(s.default,t.data,t.children);case"teacher":return e(i.default,t.data,t.children);case"employee":return e(u.default,t.data,t.children)}}}},702:function(e,t){e.exports="/app/images/roles.svg?5216e320e3eb175a9891bb04ebd627d5"},753:function(e,t,r){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("container-window",e._b({},"container-window",{title:e.title,subtitle:e.subtitle}),[n("template",{slot:"sidebar"},[n("sidebar")],1),e._v(" "),n("div",{staticClass:"container-zero my-3 py-3 text-center"},[n("img",{attrs:{src:r(702)}})]),e._v(" "),n("div",{staticClass:"container-zero py-3"},[n("div",{staticClass:"row"},[n("h2",{staticClass:"col-12 text-center"},[e._v(e._s(e.title))]),e._v(" "),n("p",{staticClass:"col-12 text-center"},[e._v("Assign roles to teachers & employees.")])])]),e._v(" "),e._l(e.roles,function(t){return n("div",[n("h6",{staticClass:"split-header text-uppercase my-3 py-3"},[e._v(e._s(t.name))]),e._v(" "),n("div",{staticClass:"container-zero py-3"},[n("div",{staticClass:"row"},[n("p",{staticClass:"col-12 pb-3 text-center"},[e._v(e._s(t.description))]),e._v(" "),n("div",{staticClass:"col-12"},[n("typeahead",e._b({attrs:{component:"SelectOptionUser",placeholder:"Start typing..."},on:{search:e.onSearch,select:function(r){return e.add(t,r)}}},"typeahead",{suggestions:e.people,value:[]}))],1),e._v(" "),t.$error?n("div",{staticClass:"col-12 mt-3"},[n("alert",{attrs:{type:"danger"},domProps:{innerHTML:e._s(t.$error)}})],1):e._e(),e._v(" "),e._l(t.$users,function(r){return n("div",{staticClass:"col-12 col-lg-6 mt-3"},[n("person-card",{class:{disabled:r.$wait},attrs:{person:r,remove:""},on:{remove:function(n){e.remove(t,r)}}})],1)}),e._v(" "),0===t.$users.length?n("div",{staticClass:"col-12 py-3 my-3 text-center text-muted"},[e._v("\n          Choose a teacher or employee\n        ")]):e._e()],2)])])}),e._v(" "),n("div",{staticStyle:{"margin-bottom":"160px"}})],2)},staticRenderFns:[]}}});
//# sourceMappingURL=24.36f47f6188d5f4e132b1.js.map